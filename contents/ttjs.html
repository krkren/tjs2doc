<?xml version="1.0" encoding="Shift_JIS"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<!-- generated by to_html.pl from ttjs.xml -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS" />
	<title>tTJS</title>
	<meta name="author" content="W.Dee" />
	<meta http-equiv="Content-Style-Type" content="text/css" />
	<meta http-equiv="Content-Script-Type" content="text/javascript" />
	<link href="browser.css" type="text/css" rel="stylesheet" title="Standard style for Kirikiri-related references" />
	<link href="mailto:dee@kikyou.info" rev="Made" />
	<link href="index.html" target="_top" rel="Start" title="Top Page" />
</head>
<body>
<h1><a id="id384" name="id384">What is tTJS</a>
</h1><div class="para"><div>
 This is the TJS2 script engine class. You can operate TJS2 through objects of this class.<br />
</div></div>
<h1><a id="id385" name="id385">Constructor</a>
</h1><div class="para"><div>
 The tTJS constructor takes no arguments.<br />
 tTJS objects cannot be created as automatic variables. They must always be created using the new operator.<br />
 The reference count immediately after creation is 1. This means that if you call the Release method as is, the tTJS object will be released.<br />
</div></div>
<h1><a id="id386" name="id386">Destructor</a>
</h1><div class="para"><div>
 The destructor for tTJS is in the protected section and cannot be accessed.<br />
 To release a tTJS object, use the Release method.<br />
 Additionally, it is recommended to call the Shutdown method before releasing the tTJS object.<br />
</div></div>

<h1><a id="id387" name="id387">AddRef</a>
</h1><div class="para"><div>
void tTJS::AddRef()<br />
<br />
 Increments the reference count of the TJS2 script engine.</div></div>
<h1><a id="id388" name="id388">Release</a>
</h1><div class="para"><div>
void tTJS::Release()<br />
<br />
 Decrements the reference count of the TJS2 script engine.<br />
 When the reference count reaches 0, the tTJS object is released.</div></div>
<h1><a id="id389" name="id389">Shutdown</a>
</h1><div class="para"><div>
void tTJS::Shutdown()<br />
<br />
 Performs the shutdown of the script engine.<br />
<br />
 When releasing the TJS2 script engine, it is recommended to call this method before the Release method.<br />
</div></div>

<h1><a id="id390" name="id390">GetGlobal</a>
</h1><div class="para"><div>
iTJSDispatch2 * tTJS::GetGlobal()<br />
<br />
 Retrieves the <a id="id391" name="id391" class="targanchor"><dfn>global object</dfn></a>. An object of the <a target="main" class="jump" href="interface.html">iTJSDispatch2 interface</a> type is returned.<br />
 When this method returns the global object, it increments its reference count.<br />
</div></div>



<h1><a id="id392" name="id392">GetGlobalNoAddRef</a>
</h1><div class="para"><div>
iTJSDispatch2 * tTJS::GetGlobalNoAddRef()<br />
<br />
 Retrieves the global object. Unlike GetGlobal, this does not increment the reference count of the global object.<br />
</div></div>



<h1><a id="id393" name="id393">SetConsoleOutput</a>
</h1><div class="para"><div>
void tTJS::SetConsoleOutput(iTJSConsoleOutput *console);<br />
<br />
 Specifies the output destination for the <a id="id394" name="id394" class="targanchor"><dfn>console</dfn></a>.<br />
 The console is where error messages and other information produced by TJS2 are output.<br />
<br />
It has the following arguments:<br />
<br />
<dl>
<dt>console</dt>
<dd> Specifies an object of the <a id="id395" name="id395" class="targanchor"><dfn>iTJSConsoleOutput</dfn></a> type that defines the console output destination.<br />
 The iTJSConsoleOutput type is a base abstract class defined in tjs.h, which has the following methods:<br />
<br />
<dl>
<dt>void iTJSConsoleOutput::<a id="id396" name="id396" class="targanchor"><dfn>ExceptionPrint</dfn></a>(const tjs_char *msg)</dt>
<dd> Method for outputting information regarding exceptions. msg represents the message.</dd>
<dt>void iTJSConsoleOutput::<a id="id397" name="id397" class="targanchor"><dfn>Print</dfn></a>(const tjs_char *msg)</dt>
<dd> Method for outputting other information. msg represents the message.</dd></dl></dd></dl>
</div></div>

<h1><a id="id398" name="id398">GetConsoleOutput</a>
</h1><div class="para"><div>
tTJSConsoleOutput * tTJS::GetConsoleOutput() const<br />
<br />
 Retrieves the console output destination.<br />
</div></div>

<h1><a id="id399" name="id399">OutputToConsole</a>
</h1><div class="para"><div>
void tTJS::OutputToConsole(const tjs_char *msg) const<br />
<br />
 Outputs a string to the console. msg is the message to output.<br />
</div></div>


<h1><a id="id400" name="id400">OutpuExceptionToConsole</a>
</h1><div class="para"><div>
void tTJS::OutpuExceptionToConsole(const tjs_char *msg) const<br />
<br />
 Outputs an exception string to the console. msg is the message to output.<br />
</div></div>



<h1><a id="id401" name="id401">OutputToConsoleWithCentering</a>
</h1><div class="para"><div>
void tTJS::OutputToConsoleWithCentering(const tjs_char *msg, tjs_uint width) const<br />
<br />
 Outputs a string to the console centered. msg is the message to output, and width is the horizontal width.<br />
 If the number of characters in the output message is less than the width, it is output centered within the specified width.
 (However, since all character widths are assumed to be identical, the display may be corrupted if full-width characters are mixed.)</div></div>





<h1><a id="id402" name="id402">OutputToConsoleSeparator</a>
</h1><div class="para"><div>
void tTJS::OutputToConsoleSeparator(const tjs_char *text, tjs_uint count) const<br />
<br />
 Outputs count instances of the separator indicated by text to the console.</div></div>




<h1><a id="id403" name="id403">Dump</a>
</h1><div class="para"><div>
void tTJS::Dump(tjs_uint width = 80) const<br />
<br />
 Outputs the state of TJS2 to the console.<br />
 The disassembly results of virtual machine code in each script block, etc., are displayed.<br />
 width specifies the output width.</div></div>


<h1><a id="id404" name="id404">ExecScript</a>
</h1><div class="para"><div>
void tTJS::ExecScript(<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char *script,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant *result = NULL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *context = NULL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char *name = NULL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int lineofs = 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
void tTJS::ExecScript(<br />
&nbsp;&nbsp;&nbsp;&nbsp;const ttstr &amp;script,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant *result = NULL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *context = NULL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char *name = NULL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int lineofs = 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
 Executes a script.<br />
<br />
 It has the following arguments:<br />
<br />
<dl>
<dt>const tjs_char *script</dt>

<dt>const ttstr &amp;script</dt>
<dd> Specifies the script to execute.</dd>


<dt>tTJSVariant *result</dt>
<dd> Specifies a pointer to a tTJSVariant type variable to receive the result.<br />
 NULL can also be specified, but in that case, the result cannot be received.</dd>
<dt>iTJSDispatch2 *context</dt>
<dd> Specifies the context in which the script is executed.<br />
 If NULL is specified, the script is executed in the global context.<br />
 Normally NULL is specified, but if you want to execute the script in a specific context, specify the object that will serve as that context.</dd>


<dt>const tjs_char *name</dt>
<dd> Specifies the name of the script. Usually, the filename of the script is specified.<br />
 Used to identify where the exception occurred when an exception is notified.</dd>

<dt>tjs_int lineofs</dt>
<dd> Specifies the starting line (0-) of the script within the source.<br />
 Specifies the start line of the TJS script when it is embedded in another document, such as a TJS script embedded in a KAG scenario.<br />
 Used to identify where the exception occurred when an exception is notified.</dd>


</dl></div></div>

<h1><a id="id405" name="id405">EvalExpression</a>
</h1><div class="para"><div>
void tTJS::EvalExpression(<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char *expression,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant *result = NULL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *context = NULL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char *name = NULL<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int lineofs = 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
void tTJS::EvalExpression(<br />
&nbsp;&nbsp;&nbsp;&nbsp;const ttstr &amp;expression,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant *result = NULL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *context = NULL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char *name = NULL<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int lineofs = 0<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
 Evaluates an expression.<br />
 Refer to ExecScript for details on the arguments.<br />
<br />
 For operators that cannot obtain a result from an expression, such as the <a id="id406" name="id406" class="targanchor"><dfn>if operator</dfn></a>, an exception will occur if a non-NULL value is specified for result in an attempt to get a result. In such cases, NULL must be specified for result.</div></div>




<h1><a id="id407" name="id407">SetPPValue</a>
</h1><div class="para"><div>
void tTJS::SetPPValue(const tjs_char *name, const tjs_int32 value)<br />
<br />
 Sets a variable for <a id="id408" name="id408" class="targanchor"><dfn>conditional compilation</dfn></a>. name is the variable name, and value is the value to set.<br />
</div></div>



<h1><a id="id409" name="id409">GetPPValue</a>
</h1><div class="para"><div>
tjs_int32 tTJS::GetPPValue(const tjs_char *name)<br />
<br />
 Retrieves a variable for conditional compilation. name is the variable name. If the variable is not found, 0 is returned.<br />
</div></div>




<h1><a id="id410" name="id410">DoGarbageCollection</a>
</h1><div class="para"><div>
tjs_int32 tTJS::DoGarbageCollection()<br />
<br />
 Performs <a id="id411" name="id411" class="targanchor"><dfn>garbage collection</dfn></a>. This clears caches held by TJS2 and completes pending cleanup processes.<br />
</div></div>
	<script type="text/javascript" charset="Shift_JIS" src="documentid.js" ></script>
	<script type="text/javascript" charset="Shift_JIS" src="postcontent.js" ></script>
</body>
</html>