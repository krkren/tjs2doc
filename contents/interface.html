<?xml version="1.0" encoding="Shift_JIS"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<!-- generated by to_html.pl from interface.xml -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS" />
	<title>iTJSDispatch2 Interface</title>
	<meta name="author" content="W.Dee" />
	<meta http-equiv="Content-Style-Type" content="text/css" />
	<meta http-equiv="Content-Script-Type" content="text/javascript" />
	<link href="browser.css" type="text/css" rel="stylesheet" title="Standard style for Kirikiri-related references" />
	<link href="mailto:dee@kikyou.info" rev="Made" />
	<link href="index.html" target="_top" rel="Start" title="Top Page" />
</head>
<body>
<h1><a id="id219" name="id219">About iTJSDispatch2</a>
</h1><div class="para"><div>
 iTJSDispatch2 is an abstract base class that provides an interface for "objects" in TJS2.<br />
 TJS2 "objects" include function objects, classes, property objects, arrays (dictionary arrays), and so on.<br />
 Most operations on TJS2 can be performed through this interface.<br />
<br />
 The following describes this interface from the perspective of the user side.<br />
</div></div>



<h1><a id="id220" name="id220">Call by Ordinal</a>
</h1><div class="para"><div>
<br />
 Some iTJSDispatch2 methods have names ending in "ByNum". These perform calls by ordinal (index); for example, calling FuncCall with a member name of "23" is equivalent to calling FuncCallByNum with the ordinal 23.<br />
 This is useful when accessing array objects.<br />
<br />
 Methods ending in ByNum do not have the membername and hint arguments of the non-ByNum counterparts with the same name, but instead have tjs_int num. Specify the ordinal in the num argument.<br />
<br />
 Detailed explanations for methods that perform calls by ordinal will be omitted below (please refer to the descriptions of the corresponding methods without the ByNum suffix).<br />
</div></div>








<h1><a id="id221" name="id221">AddRef</a>
</h1><div class="para"><div>
tjs_uint iTJSDispatch2::AddRef(void)<br />
<br />
 Increments the reference counter of the object.<br />
 Each object in TJS2 is managed by a reference counter.<br />
 The return value is the reference counter value after incrementing, but relying on this value is not recommended.<br />
</div></div>








<h1><a id="id222" name="id222">Release</a>
</h1><div class="para"><div>
tjs_uint iTJSDispatch2::Release(void)<br />
<br />
 Decrements the reference counter of the object.<br />
 The return value is the reference counter value after decrementing; a return value of 0 indicates that the object has been released. However, relying on this value is not recommended.<br />
</div></div>












<h1><a id="id223" name="id223">FuncCall</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::FuncCall(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char * membername,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 *hint,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant *result,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int numparams,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant **param,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
 Executes a function call.<br />
<br />
 The arguments are as follows:<br />
<br />
<dl>
<dt>tjs_uint32 flag</dt>
<dd> Call flag (see below).</dd>

<dt>const tjs_char * membername</dt>
<dd> The name of the member to be operated on.<br />
 If NULL, the operation is on the object itself. In this case, the object must have function capabilities.</dd>

<dt>tjs_uint32 *hint</dt>
<dd> Specifies the area for a variable to store a "<a id="id224" name="id224" class="targanchor"><dfn>hint</dfn></a>". It can be NULL.<br />
 Hints are intended to allow faster searches for the same member name from the second time onwards. If a pointer to a tjs_uint32 variable is specified in hint, a numeric value serving as a hint will be written there. From the second time onwards, the member is searched with reference to that value. Since it is only a reference, the initial value of the hint can be any value (0 is recommended). Also, because of this mechanism, it is more efficient if the hint and its corresponding member name have a one-to-one correspondence (the tTJSString type has a mechanism for this hint).<br />
 Depending on the object, it may not have a mechanism to utilize hints.</dd>

<dt>tTJSVariant *result</dt>
<dd> Specifies a pointer to a tTJSVariant type to store the result of the function call.<br />
 If the result is not needed, NULL may be specified.</dd>

<dt>tjs_int numparams</dt>
<dd> Specifies the number of arguments to pass to the function.</dd>

<dt>tTJSVariant **param</dt>
<dd> Passes an array of pointers to the arguments to be passed to the function. If there are no arguments, it may be NULL.</dd>

<dt>iTJSDispatch2 *objthis</dt>
<dd> Specifies the context (this object) in which the function is executed.</dd></dl></div></div>




<h1><a id="id225" name="id225">FuncCallByNum</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::FuncCall(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int num,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant *result,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int numparams,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant **param,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
 Executes a function call by ordinal.<br />
</div></div>



<h1><a id="id226" name="id226">PropGet</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::PropGet(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char * membername,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 *hint,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant *result,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
 Retrieves the value of a property or member variable.<br />
<br />
 The arguments are as follows:<br />
<br />
<dl>
<dt>tjs_uint32 flag</dt>
<dd> Call flag (see below).</dd>

<dt>const tjs_char * membername</dt>
<dd> The name of the member to be operated on.<br />
<br />
 If NULL, the operation is on the object itself. In this case, the object must have property retrieval capabilities.<br />
 Objects that succeed even if this argument is NULL are considered property objects. Normally, if such a property object becomes a member of another object, the result of performing PropGet on that property object is used instead of the property object itself. This behavior can be bypassed by specifying TJS_IGNOREPROP in the call flag.</dd>

<dt>tjs_uint32 *hint</dt>
<dd> Specifies the area for a variable to store a hint. It can be NULL.<br />
 For a description of hints, refer to the description of FuncCall.</dd>

<dt>tTJSVariant *result</dt>
<dd> Specifies a pointer to a tTJSVariant type to store the result. NULL is not allowed.</dd>

<dt>iTJSDispatch2 *objthis</dt>
<dd> Specifies the context (this object) in which this method is executed.</dd></dl></div></div>


<h1><a id="id227" name="id227">PropGetByNum</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::PropGetByNum(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int num,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant *result,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
 Retrieves the value of a property or member variable by ordinal.<br />
</div></div>






<h1><a id="id228" name="id228">PropSet</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::PropSet(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char *membername,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 *hint,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tTJSVariant *param,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
 Sets the value of a property or member variable.<br />
<br />
 The arguments are as follows:<br />
<br />
<dl>
<dt>tjs_uint32 flag</dt>
<dd> Call flag (see below).</dd>

<dt>const tjs_char * membername</dt>
<dd> The name of the member to be operated on.<br />
<br />
 If NULL, the operation is on the object itself. In this case, the object must have property setting capabilities.<br />
 Objects that succeed even if this argument is NULL are considered property objects. Normally, if such a property object becomes a member of another object, PropSet is called on that property object instead of the property object itself. This behavior can be bypassed by specifying TJS_IGNOREPROP in the call flag.</dd>

<dt>tjs_uint32 *hint</dt>
<dd> Specifies the area for a variable to store a hint. It can be NULL.<br />
 For a description of hints, refer to the description of FuncCall.</dd>

<dt>const tTJSVariant *param</dt>
<dd> Specifies a pointer to a tTJSVariant type variable representing the value to be set. NULL is not allowed.</dd>

<dt>iTJSDispatch2 *objthis</dt>
<dd> Specifies the context (this object) in which this method is executed.</dd></dl></div></div>

<h1><a id="id229" name="id229">PropSetByVS</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::PropSetByVS(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariantString *membername,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tTJSVariant *param,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
 Sets the value of a property or member variable. The difference from PropSet is that the member name is referenced by a tTJSVariantString. This is used internally. Since tTJSVariantString has a mechanism where multiple string objects share the same memory area for the string, setting properties (creating members within an object) via this method can prevent the increase of memory used for the string memory area for member names.<br />
 If you do not implement this method, return TJS_E_NOTIMPL. PropSet will be used instead. Also, if calling this method returns TJS_E_NOTIMPL, implement it so that PropSet is used instead.<br />
<br />
</div></div>





<h1><a id="id230" name="id230">PropSetByNum</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::PropSetByNum(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int num,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tTJSVariant *param,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
 Sets the value of a property or member variable by ordinal.<br />
</div></div>






<h1><a id="id231" name="id231">GetCount</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::GetCount(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int *result,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char *membername,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 *hint,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
 Returns the number of members held by the object.<br />
<br />
 The arguments are as follows:<br />
<br />
<dl>
<dt>tjs_int *result</dt>
<dd> Specifies a pointer to a variable to store the result. NULL is not allowed.</dd>

<dt>const tjs_char * membername</dt>
<dd> Specifies the name of the target member.<br />
 If NULL, the number of members held by the object itself is returned.<br />
 If a member name is specified, and if that member is an object, the number of members held by that object is returned. It fails if the specified member is not of an object type.</dd>

<dt>tjs_uint32 *hint</dt>
<dd> Specifies the area for a variable to store a hint. It can be NULL.<br />
 For a description of hints, refer to the description of FuncCall.</dd>

<dt>iTJSDispatch2 *objthis</dt>
<dd> Specifies the context (this object) in which this method is executed.<br />
 This argument normally has no meaning (it is ignored).</dd></dl></div></div>



<h1><a id="id232" name="id232">GetCountByNum</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::GetCount(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int *result,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int num,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
 This is the ordinal version of GetCount.<br />
</div></div>


<h1><a id="id233" name="id233">DeleteMember</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::DeleteMember(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char *membername,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 *hint,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
 Deletes a member.<br />
<br />
 The arguments are as follows:<br />
<br />
<dl>
<dt>tjs_uint32 flag</dt>
<dd> Call flag (see below).</dd>

<dt>const tjs_char * membername</dt>
<dd> Specifies the name of the target member. NULL is not allowed.</dd>

<dt>tjs_uint32 *hint</dt>
<dd> Specifies the area for a variable to store a hint. It can be NULL.<br />
 For a description of hints, refer to the description of FuncCall.</dd>

<dt>iTJSDispatch2 *objthis</dt>
<dd> Specifies the context (this object) in which this method is executed.<br />
 This argument normally has no meaning (it is ignored).</dd></dl></div></div>





<h1><a id="id234" name="id234">DeleteMemberByNum</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::DeleteMemberByNum(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int num,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
 Deletes a member by ordinal.<br />
</div></div>


<h1><a id="id235" name="id235">EnumMembers</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::EnumMembers(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariantClosure *callback,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
 Enumerates the members within the object.<br />
 A callback function can be specified in callback, but in the current version, behavior when creating or deleting members of this object within the callback function is not guaranteed.<br />
<br />
 The arguments are as follows:<br />
&nbsp;&nbsp; <br />
<dl>
<dt>tjs_uint32 flag</dt>
<dd> Call flag. For the call flag, specify the bitwise OR of the following flags or 0 (zero).<br />
<dl>
<dt>TJS_IGNOREPROP</dt>
<dd> Disables property access. When enumerating members and also retrieving values, if this flag is specified and the member is a property, the property object itself is obtained. If this flag is not specified, the value obtained through the property object is obtained.<br />
</dd>
<dt>TJS_ENUM_NO_VALUE</dt>
<dd> Does not retrieve values. If this flag is specified, the number of arguments passed to the callback function will be 2. If not specified, it will be 3.<br />
</dd></dl></dd>
<dt>tTJSVariantClosure *callback</dt>
<dd> Specifies the callback function.<br />
 This callback function's callback-&gt;FuncCall is called once for each member.<br />
 The function is passed two (if TJS_ENUM_NO_VALUE is specified) or three (if TJS_ENUM_NO_VALUE is not specified) arguments.<br />
<ul><li>The 1st argument is a string type and is the member name.</li><li>The 2nd argument is an integer type and is the flags for that member. A combination of the bitwise OR of TJS_HIDDENMEMBER or TJS_STATICMEMBER, or 0, is specified.</li><li>The 3rd argument exists only if TJS_ENUM_NO_VALUE was not specified and represents the value of that member.</li></ul></dd>

<dt>iTJSDispatch2 *objthis</dt>
<dd> Specifies the context (this object) in which this method is executed.<br />
 This argument becomes the default context in which property objects are executed if the TJS_IGNOREPROP flag is not specified.<br />
</dd></dl>


</div></div>







<h1><a id="id236" name="id236">Invalidate</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::Invalidate(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char *membername,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 *hint,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
 Performs invalidation.<br />
<br />
&nbsp;&nbsp;The arguments are as follows:<br />
<br />
<dl>
<dt>tjs_uint32 flag</dt>
<dd> Call flag (see below).</dd>

<dt>const tjs_char * membername</dt>
<dd> Specifies the name of the target member.<br />
 If NULL, the object itself is invalidated.<br />
 If a member name is specified, and if that member is an object, that object is invalidated. It fails if the specified member is not of an object type.</dd>

<dt>tjs_uint32 *hint</dt>
<dd> Specifies the area for a variable to store a hint. It can be NULL.<br />
 For a description of hints, refer to the description of FuncCall.</dd>

<dt>iTJSDispatch2 *objthis</dt>
<dd> Specifies the context (this object) in which this method is executed.<br />
 This argument normally has no meaning (it is ignored).</dd></dl></div></div>


<h1><a id="id237" name="id237">InvalidateByNum</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::InvalidateByNum(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int num,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
Performs invalidation by ordinal.<br />
</div></div>




<h1><a id="id238" name="id238">IsValid</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::IsValid(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char *membername,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 *hint,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
 Checks whether the object is valid.<br />
 Returns TJS_S_TRUE if valid, or TJS_S_FALSE if invalid.<br />
<br />
 The arguments are as follows:<br />
<br />
<dl>
<dt>tjs_uint32 flag</dt>
<dd> Call flag (see below).</dd>

<dt>const tjs_char * membername</dt>
<dd> Specifies the name of the target member.<br />
 If NULL, the validity of the object itself can be checked.<br />
 If a member name is specified, and if that member is an object, the validity of that object can be checked. It fails if the specified member is not of an object type.
</dd>

<dt>tjs_uint32 *hint</dt>
<dd> Specifies the area for a variable to store a hint. It can be NULL.<br />
 For a description of hints, refer to the description of FuncCall.</dd>

<dt>iTJSDispatch2 *objthis</dt>
<dd> Specifies the context (this object) in which this method is executed.<br />
 This argument normally has no meaning (it is ignored).</dd></dl></div></div>






<h1><a id="id239" name="id239">IsValidByNum</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::IsValidByNum(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int num,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
 Checks whether the object is valid by ordinal.<br />
</div></div>





<h1><a id="id240" name="id240">CreateNew</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::CreateNew(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char * membername,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 *hint,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 **result,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int numparams,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant **param,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
 Creates a new object.<br />
 Similar to the FuncCall method, arguments can be passed to create a new object.<br />
 So-called "class objects," which serve as templates for objects, must implement this method.<br />
<br />
 The arguments are as follows:<br />
<br />
<dl>
<dt>tjs_uint32 flag</dt>
<dd> Call flag (see below).</dd>

<dt>const tjs_char * membername</dt>
<dd> The name of the member to be operated on.<br />
 If NULL, the operation is on the object itself. In this case, the object must have the capability to create new objects.</dd>

<dt>tjs_uint32 *hint</dt>
<dd> Specifies the area for a variable to store a hint. It can be NULL.<br />
 For a description of hints, refer to the description of FuncCall.</dd>

<dt>iTJSDispatch2 **result</dt>
<dd> Specifies a pointer to an iTJSDispatch * type to store the newly created object. NULL is not allowed.</dd>

<dt>tjs_int numparams</dt>
<dd> Specifies the number of arguments to pass when creating a new object.</dd>

<dt>tTJSVariant **param</dt>
<dd> Passes an array of pointers to the arguments to be passed when creating a new object. If there are no arguments, it may be NULL.</dd>

<dt>iTJSDispatch2 *objthis</dt>
<dd> Specifies the context (this object) executed when creating a new object.</dd></dl></div></div>




<h1><a id="id241" name="id241">CreateNewByNum</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::CreateNew(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int num,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 **result,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int numparams,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant **param,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
 Creates a new object by ordinal.<br />
</div></div>







<h1><a id="id242" name="id242">IsInstanceOf</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::IsInstanceOf(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char * membername,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 *hint,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char * classname,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
 Checks whether an object is an instance of a specific class.<br />
 The class name is passed as a string in the classname argument.<br />
 Referenced by the TJS2 instanceof operator.<br />
 If successful, TJS_S_TRUE is returned if it is an instance of the specified class, and TJS_S_FALSE is returned otherwise.<br />
<br />
 The arguments are as follows:<br />
<br />
<dl>
<dt>tjs_uint32 flag</dt>
<dd> Call flag (see below).</dd>

<dt>const tjs_char * membername</dt>
<dd> The name of the member to be operated on.<br />
 If NULL, the operation is on the object itself. In this case, the object must have the capability to create new objects.</dd>

<dt>tjs_uint32 *hint</dt>
<dd> Specifies the area for a variable to store a hint. It can be NULL.<br />
 For a description of hints, refer to the description of FuncCall.</dd>

<dt>const tjs_char *classname</dt>
<dd> Specifies the class name as a string.</dd>

<dt>iTJSDispatch2 *objthis</dt>
<dd> Specifies the context (this object) executed when creating a new object.</dd></dl></div></div>



<h1><a id="id243" name="id243">IsInstanceOfByNum</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::IsInstanceOfByNum(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int num,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char * classname,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
 Checks whether an object is an instance of a specific class by ordinal.<br />
</div></div>



<h1><a id="id244" name="id244">Operation</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::Operation(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char *membername,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 *hint,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant *result,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tTJSVariant *param,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
 Performs an operation on a member. Specify the type of operation in flag.<br />
<br />
 The arguments are as follows:<br />
<br />
<dl>
<dt>tjs_uint32 flag</dt>
<dd> Call flag. In addition to the normal call flags below, one of the following flags must be added with a bitwise OR to specify the type of operation.<br />
<br />
 Note that in this description, v represents the member value and p represents the parameter passed in the param argument.<br />
<br />
<dl>
<dt>TJS_OP_BAND</dt>
<dd>Bitwise AND operation<br />
v &amp;= p</dd>

<dt>TJS_OP_BOR</dt>
<dd>Bitwise OR operation<br />
v |= p</dd>

<dt>TJS_OP_BXOR</dt>
<dd>Bitwise XOR operation<br />
v ^= p</dd>

<dt>TJS_OP_SUB</dt>
<dd>Subtraction<br />
v -= p</dd>

<dt>TJS_OP_ADD</dt>
<dd>Addition<br />
v += p</dd>

<dt>TJS_OP_MOD</dt>
<dd>Modulo<br />
v %= p</dd>

<dt>TJS_OP_DIV</dt>
<dd>Float division<br />
v /= p</dd>

<dt>TJS_OP_IDIV</dt>
<dd>Integer division<br />
v \= p</dd>

<dt>TJS_OP_MUL</dt>
<dd>Multiplication<br />
v *= p</dd>

<dt>TJS_OP_LOR</dt>
<dd>Logical OR<br />
v = v || p</dd>

<dt>TJS_OP_LAND</dt>
<dd>Logical AND<br />
v = v &amp;&amp; p</dd>

<dt>TJS_OP_SAR</dt>
<dd>Arithmetic right shift<br />
v &gt;&gt;= p</dd>

<dt>TJS_OP_SAL</dt>
<dd>Arithmetic left shift<br />
v &lt;&lt;= p</dd>

<dt>TJS_OP_SR</dt>
<dd>Bitwise right shift<br />
v &gt;&gt;&gt;= p</dd>

<dt>TJS_OP_INC</dt>
<dd>Increment<br />
v++<br />
The param argument is ignored</dd>

<dt>TJS_OP_DEC</dt>
<dd>Decrement<br />
v--<br />
The param argument is ignored</dd></dl>
</dd>

<dt>const tjs_char * membername</dt>
<dd> The name of the member to be operated on. NULL is not allowed.</dd>

<dt>tjs_uint32 *hint</dt>
<dd> Specifies the area for a variable to store a hint. It can be NULL.<br />
 For a description of hints, refer to the description of FuncCall.</dd>

<dt>tTJSVariant *result</dt>
<dd> Specifies a pointer to a tTJSVariant type variable to store the result of the operation. It can be NULL.</dd>

<dt>tTJSVariant *param</dt>
<dd> Specifies the parameter for the operation. It can be NULL if TJS_OP_INC or TJS_OP_DEC is specified as the operation type.</dd>

<dt>iTJSDispatch2 *objthis</dt>
<dd> Specifies the context in which the operation is executed, but it is normally ignored.</dd></dl></div></div>




<h1><a id="id245" name="id245">OperationByNum</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::OperationByNum(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int num,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant *result,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tTJSVariant *param,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
 Performs an operation on a member using an ordinal.<br />
</div></div>



<h1><a id="id246" name="id246">NativeInstanceSupport</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::NativeInstanceSupport(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int32 classid,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSNativeInstance **pointer<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
 Associates a native code instance with the object, or retrieves a native code instance from the object.<br />
<br />
 The arguments are as follows:<br />
<br />
<dl>
<dt>tjs_uint32 flag</dt>
<dd> Specifies the call flag.<br />
 One of the following values must be specified:<br />
<br />
<dl>
<dt><a id="id247" name="id247" class="targanchor"><dfn>TJS_NIS_REGISTER</dfn></a></dt>
<dd> Registers the native code instance indicated by *pointer. classid is used to identify the native code class.</dd>


<dt><a id="id248" name="id248" class="targanchor"><dfn>TJS_NIS_GETINSTANCE</dfn></a></dt>
<dd> Writes the native code instance having the class ID specified by classid to *pointer.</dd></dl></dd>


<dt>tjs_int32 classid</dt>
<dd> Specifies the native code class ID.<br />
 TJSRegisterNativeClass, TJSFindNativeClassID, and TJSFindNativeClassName can be used to manage native code class IDs, but these processes are normally handled automatically by the support code group (written in tjsNative.cpp/tjsNative.h) for writing native code.</dd>


<dt>iTJSNativeInstance **pointer</dt>
<dd> Specifies a pointer to an iTJSNativeInstance * type variable for passing or receiving a native code instance.</dd></dl></div></div>


<h1><a id="id249" name="id249">ClassInstanceInfo</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::ClassInstanceInfo(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint num,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant *value<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
 A method for manipulating class instance information used by the IsInstanceOf method.<br />
 You can add class names to identify which class an object is an instance of, or enumerate classes to check which class an object is an instance of.<br />
<br />
 The arguments are as follows:<br />
<br />
<dl>
<dt>tjs_uint32 flag</dt>
<dd> Call flag. Specify one of the following flags.<br />
<br />
<dl>
<dt><a id="id250" name="id250" class="targanchor"><dfn>TJS_CII_ADD</dfn></a></dt>
<dd> Adds instance information.<br />
 Pass a pointer to a tTJSVariant type variable storing the class name (string) in value.<br />
 The num argument is ignored.</dd>

<dt><a id="id251" name="id251" class="targanchor"><dfn>TJS_CII_GET</dfn></a></dt>
<dd> Retrieves instance information.<br />
 Specify a 0-based integer in the num argument. If a num exceeding the number of set instance information is specified, TJS_E_FAIL is returned.<br />
 Pass a pointer to a tTJSVariant type variable to receive the class name in value.</dd></dl></dd>


<dt>tjs_uint num</dt>
<dd> Specifies the ordinal when TJS_CII_GET is specified for flag.</dd>


<dt>tTJSVariant *value</dt>
<dd> If TJS_CII_ADD is specified for flag, pass a pointer to a tTJSVariant type variable storing the class name.<br />
&nbsp;&nbsp;If TJS_CII_GET is specified for flag, pass a pointer to a tTJSVariant type variable to receive the class name.</dd></dl>
</div></div>


<h1><a id="id252" name="id252">Call Flags</a>
</h1><div class="para"><div>

 Call flags.<br />
 A combination of the following values by bitwise OR can be specified:<br />
<br />
<dl>
<dt>TJS_MEMBERENSURE</dt>
<dd> If the specified member name is not found, forcefully creates the member. Effective as a call flag for PropSet.</dd>

<dt>TJS_MEMBERMUSTEXIST</dt>
<dd> If the specified member name is not found, results in an error. This is effective for objects such as Dictionary or Array that return void by default when a member is not found (for objects that are not like that, it defaults to an error if a member is not found).</dd>




<dt>TJS_IGNOREPROP</dt>
<dd> Bypasses property operations.<br />
 Normally, if a specified member of a TJS2 object is an object and PropSet or PropGet succeeds on that object (in the case of a property object), the result of PropSet or PropGet on that member is used instead of the member itself.<br />
 If this flag is specified, this process is bypassed, so even if the specified member is a property object, the operation will be on the property object itself.</dd>

<dt>TJS_HIDDENMEMBER</dt>
<dd> If a member is created with this flag specified, the member becomes invisible. It may not be supported by some objects.</dd>
<dt>TJS_STATICMEMBER</dt>
<dd> If a member is created with this flag specified, the member becomes static (independent of execution context). It may not be supported by some objects.</dd>
</dl></div></div>

<h1><a id="id253" name="id253">tjs_error</a>
</h1><div class="para"><div>
 tjs_error is an error type returned by each method of iTJSDispatch2 (excluding AddRef and Release).<br />
 It takes the following values. Also, for values not listed here, if the value is negative, it must be considered an error. The TJS_SUCCEEDED and TJS_FAILED macros can be used to determine these.<br />
<br />
<dl>
<dt><a id="id254" name="id254" class="targanchor"><dfn>TJS_E_MEMBERNOTFOUND</dfn></a></dt>
<dd> The specified member was not found.</dd>


<dt><a id="id255" name="id255" class="targanchor"><dfn>TJS_E_NOTIMPL</dfn></a></dt>
<dd> The functionality attempted to be called is not implemented.</dd>


<dt><a id="id256" name="id256" class="targanchor"><dfn>TJS_E_INVALIDPARAM</dfn></a></dt>
<dd> Invalid argument.</dd>


<dt><a id="id257" name="id257" class="targanchor"><dfn>TJS_E_BADPARAMCOUNT</dfn></a></dt>
<dd> Invalid number of arguments.</dd>


<dt><a id="id258" name="id258" class="targanchor"><dfn>TJS_E_INVALIDTYPE</dfn></a></dt>
<dd> Not a function or property type mismatch.<br />
 This value is returned when trying to call something that is not a function, or trying to treat something that is not a property as a property.</dd>


<dt><a id="id259" name="id259" class="targanchor"><dfn>TJS_E_INVALIDOBJECT</dfn></a></dt>
<dd> The object has already been invalidated.</dd>


<dt><a id="id260" name="id260" class="targanchor"><dfn>TJS_E_ACCESSDENYED</dfn></a></dt>
<dd> An operation was attempted that cannot be performed on a read-only or write-only property.</dd>


<dt><a id="id261" name="id261" class="targanchor"><dfn>TJS_E_NATIVECLASSCRASH</dfn></a></dt>
<dd> Execution context mismatch.<br />
 This value is returned when trying to execute a method implemented in native code in a context that cannot be handled by that native code (such as on an object of a different class).</dd>


<dt><a id="id262" name="id262" class="targanchor"><dfn>TJS_S_TRUE</dfn></a></dt>
<dd> Not an error, but indicates the result is "true".</dd>


<dt><a id="id263" name="id263" class="targanchor"><dfn>TJS_S_FALSE</dfn></a></dt>
<dd> Not an error, but indicates the result is "false".</dd>


<dt><a id="id264" name="id264" class="targanchor"><dfn>TJS_S_OK</dfn></a></dt>
<dd> This value is normally returned when no error has occurred.</dd>


<dt><a id="id265" name="id265" class="targanchor"><dfn>TJS_E_FAIL</dfn></a></dt>
<dd> This value is returned when an undefined error occurs.</dd>


<dt><a id="id266" name="id266" class="targanchor"><dfn>TJS_FAILED</dfn></a>(x)</dt>
<dd> A macro that evaluates to true if x is an error value.</dd>

<dt><a id="id267" name="id267" class="targanchor"><dfn>TJS_SUCCEEDED</dfn></a>(x)</dt>
<dd> A macro that evaluates to true if x is not an error value.</dd></dl><br />

<br />
 Error definitions and related macros are described in tjsErrorDef.h.<br />
 Also, runtime exceptions (in C++) may be thrown instead of errors. Regarding programming, runtime exceptions must be sufficiently taken into account.<br />
</div></div>

	<script type="text/javascript" charset="Shift_JIS" src="documentid.js" ></script>
	<script type="text/javascript" charset="Shift_JIS" src="postcontent.js" ></script>
</body>
</html>